// -- Sammy.js -- plugins/sammy.form.js
// http://sammyjs.org
// Version: 0.7.0
// Built: 2011-08-08T12:31:53+0200
(function(a){function c(c,d,e){var f="<";f+=c,typeof d!="undefined"&&a.each(d,function(a,c){c!=null&&(f+=" "+a+"='",f+=b(d,c).replace(/\'/g,"'"),f+="'")}),e===!1?f+=">":typeof e!="undefined"?(f+=">",f+=b(this,e),f+="</"+c+">"):f+=" />";return f}function b(b,c){if(typeof c=="undefined")return"";a.isFunction(c)&&(c=c.apply(b));return c.toString()}Sammy=Sammy||{},Sammy.FormBuilder=function(a,b){this.name=a,this.object=b},a.extend(Sammy.FormBuilder.prototype,{open:function(b){return c("form",a.extend({method:"post",action:"#/"+this.name+"s"},b),!1)},close:function(){return"</form>"},label:function(b,d,e){var f={"for":this._attributesForKeyPath(b).name};return c("label",a.extend(f,e),d)},hidden:function(b,d){d=a.extend({type:"hidden"},this._attributesForKeyPath(b),d);return c("input",d)},text:function(b,d){d=a.extend({type:"text"},this._attributesForKeyPath(b),d);return c("input",d)},textarea:function(b,d){var e;d=a.extend(this._attributesForKeyPath(b),d),e=d.value,delete d.value;return c("textarea",d,e)},password:function(b,c){return this.text(b,a.extend({type:"password"},c))},select:function(d,e,f){var g="",h;f=a.extend(this._attributesForKeyPath(d),f),h=f.value,delete f.value,a.each(e,function(d,e){var f,i,j;a.isArray(e)?(f=e[1],i=e[0]):(f=e,i=e),j={value:b(this.object,f)},f===h&&(j.selected="selected"),g+=c("option",j,i)});return c("select",f,g)},radio:function(d,e,f){var g;f=a.extend(this._attributesForKeyPath(d),f),g=f.value,f.value=b(this.object,e),g==f.value&&(f.checked="checked");return c("input",a.extend({type:"radio"},f))},checkbox:function(b,c,d){var e="";d||(d={}),d.hidden_element!==!1&&(e+=this.hidden(b,{value:!c})),delete d.hidden_element,e+=this.radio(b,c,a.extend({type:"checkbox"},d));return e},submit:function(b){return c("input",a.extend({type:"submit"},b))},_attributesForKeyPath:function(c){var d=this,e=a.isArray(c)?c:c.split(/\./),f=d.name,g=d.object,h=d.name;a.each(e,function(a,b){typeof g=="undefined"||g==""?g="":typeof b=="number"||b.match(/^\d+$/)?g=g[parseInt(b,10)]:g=g[b],f+="["+b+"]",h+="-"+b});return{name:f,value:b(d.object,g),"class":h}}}),Sammy.Form=function(b){b.helpers({simple_element:c,formFor:function(b,c,d){var e;a.isFunction(c)&&(d=c,c=this[b]),e=new Sammy.FormBuilder(b,c),d.apply(this,[e]);return e}})}})(jQuery)